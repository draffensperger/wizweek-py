{"version":3,"sources":["scripts/app.js"],"names":["angular","module","WelcomeController","auth","vm","this","$inject","component","controller","controllerAs","templateUrl","settingsStore","$q","$window","api","save","value","saveSettings","load","defaultSettings","settings","resolve","loadSettings","then","resp","extend","data","parseDates","workStartTimes","workEndTimes","values","i","length","Date","service","SettingsController","GApi","$log","toastr","activate","loadCalendars","loadedSettings","success","request","path","calendars","result","items","debug","weekDays","appointmentsCalId","tasksCalId","Array","fill","concat","lastSignIn","signedIn","expiresAt","localStorage","signInExpiry","signedOut","isLikelyActive","msLeft","parseInt","getTime","GAuth","gapiScopes","gapiClientId","$state","$rootScope","currentUserChanged","user","signingIn","isSignedIn","userEmail","getBasicProfile","getEmail","userName","getName","token","getAuthResponse","access_token","expires_at","$digest","checkAuth","signIn","signOut","setConfig","clientId","scope","currentUserListener","$http","get","headers","Authorization","put","NavbarController","isActive","state","current","name","MainController","AuthorizedController","FooterController","DashboardController","conf","config","init","auth2","getAuthInstance","initialized","client_id","currentUser","listen","cachedAuth2","gapi","$document","$timeout","args","client","gapiLoaded","when","deferred","defer","observerCallbacks","push","gapiLoading","loadWithClientAndAuth","forEach","c","promise","loadScript","URL","_gapiOnLoad","script","createElement","onerror","e","reject","src","body","appendChild","runBlock","run","routerConfig","$stateProvider","$urlRouterProvider","abstract","url","otherwise","constant","malarkey","moment","$logProvider","toastrConfig","debugEnabled","allowHtml","timeOut","positionClass","preventDuplicates","progressBar","preventOpenDuplicates","maxOpened","$templateCache"],"mappings":"CAAA,WACE,YAIAA,SACGC,OAAO,uBAEVD,QACGC,OAAO,aACN,YAAa,YAAa,UAAW,aAAc,aAAc,SACjE,aAAc,YAAa,eAAgB,SAAU,eACrD,iBAAkB,wBAKxB,WACE,YAWA,SAASC,GAAkBC,GACzB,GAAIC,GAAKC,IACTD,GAAGD,KAAOA,EAXZD,EAAkBI,SAAW,QAA7BN,QACCC,OAAO,aACPM,UAAU,aACTC,WAAYN,EACZO,aAAc,UACdC,YAAa,gCAUjB,WACE,YAOA,SAASC,GAAcC,EAAIC,EAASC,GASlC,QAASC,GAAKC,GACZ,MAAOF,GAAIG,aAAaD,GAG1B,QAASE,GAAKC,GACZ,MAAIC,GAEKR,EAAGS,QAAQD,GAEXN,EAAIQ,eAAeC,KAAK,SAASC,GAMtC,MAHAJ,GAAWpB,QAAQyB,UAAWN,EAAiBK,EAAKE,MACpDC,EAAWP,EAASQ,gBACpBD,EAAWP,EAASS,cACbT,IAKb,QAASO,GAAWG,GAClB,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAOE,OAAQD,IACjCD,EAAOC,GAAK,GAAIE,MAAKH,EAAOC,IA9BhC,GAAIX,GAAW,KAEXc,GACFhB,KAAMA,EACNH,KAAMA,EAER,OAAOmB,GAXTvB,EAAcL,SAAW,KAAM,UAAW,OAD1CN,QACCC,OAAO,aACPiC,QAAQ,gBAAiBvB,MAwC5B,WACE,YAOA,SAASwB,GAAmBC,EAAMC,EAAM1B,EAAe2B,GAoBrD,QAASC,KACPC,IACAlB,IAGF,QAASA,KACPX,EAAcO,KAAKC,GAAiBI,KAAK,SAASkB,GAChDrC,EAAGgB,SAAWqB,IAIlB,QAASxB,KACPN,EAAcI,KAAKX,EAAGgB,UAAUG,KAAK,WACnCe,EAAOI,QAAQ,qBAInB,QAASF,KACPJ,EAAKO,SACHC,KAAM,uCACLrB,KACD,SAASC,GACPpB,EAAGyC,UAAYrB,EAAKsB,OAAOC,OAE7B,WACE3C,EAAGyC,aACHR,EAAKW,MAAM,2BA7CjB,GAAI5C,GAAKC,IACTD,GAAGyC,aACHzC,EAAG6C,UAAY,SAAS,SAAS,UAAU,YAAY,WAAW,SAAS,WAC3E,IAAI9B,IACF+B,kBAAmB,KAAMC,WAAY,KAIrCvB,eAAgBwB,MAAM,GAAGC,KAAK,GAAIpB,MAAK,EAAG,EAAG,EAAG,IAChDJ,cAAe,GAAII,MAAK,EAAG,EAAG,EAAG,IAAIqB,OACnCF,MAAM,GAAGC,KAAK,GAAIpB,MAAK,EAAG,EAAG,EAAG,MAAMqB,QACrC,GAAIrB,MAAK,EAAG,EAAG,EAAG,KAGvB7B,GAAGgB,YACHhB,EAAGa,aAAeA,EAElBsB,IArBFJ,EAAmB7B,SAAW,OAAQ,OAAQ,gBAAiB,UAF/DN,QACCC,OAAO,aACPO,WAAW,qBAAsB2B,MAwDpC,WACE,YAOA,SAASoB,GAAW1C,GAQlB,QAAS2C,GAASC,GAChB5C,EAAQ6C,aAAaC,aAAeF,EAGtC,QAASG,KACP/C,EAAQ6C,aAAaC,aAAe,EAGtC,QAASE,KACP,GAAIF,GAAe9C,EAAQ6C,aAAaC,YACxC,IAAKA,EAEE,CACL,GAAIG,GAASC,SAASJ,IAAgB,GAAI1B,OAAO+B,SACjD,OAAOF,GAAS,EAHhB,OAAO,EAlBX,GAAI5B,IACF2B,eAAgBA,EAChBL,SAAUA,EACVI,UAAWA,EAEb,OAAO1B,GARTqB,EAAWjD,SAAW,WAHtBN,QACCC,OAAO,aACPiC,QAAQ,aAAcqB,MA+BzB,WACE,YAOA,SAASpD,GAAK8D,EAAOC,EAAYC,EAAcC,EAAQC,EAAYd,GAmBjE,QAASe,GAAmBC,GAC1BrC,EAAQsC,WAAY,EACpBtC,EAAQsB,SAAWe,EAAKE,aACpBvC,EAAQsB,UACVtB,EAAQwC,UAAYH,EAAKI,kBAAkBC,WAC3C1C,EAAQ2C,SAAWN,EAAKI,kBAAkBG,UAC1C5C,EAAQ6C,MAAQR,EAAKS,kBAAkBC,aACvC1B,EAAWC,SAASe,EAAKS,kBAAkBE,cAE3ChD,EAAQwC,UAAY,KACpBxC,EAAQ2C,SAAW,KACnB3C,EAAQ6C,MAAQ,KAChBxB,EAAWK,aAEbS,EAAWc,UAGb,QAASC,KACPnB,EAAMmB,YAGR,QAASC,KACPnD,EAAQsC,WAAY,EACpBP,EAAMoB,SAGR,QAASC,KACPrB,EAAMqB,UA7CRrB,EAAMsB,WACJC,SAAUrB,EACVsB,MAAOvB,EACPwB,oBAAqBpB,GAGvB,IAAIpC,IACFkD,UAAWA,EACXC,OAAQA,EACRC,QAASA,EACT9B,UAAU,EACVgB,WAAW,EACXE,UAAW,KACXG,SAAU,KACVE,MAAO,KAET,OAAO7C,GAlBT/B,EAAKG,SAAW,QAAS,aAAc,eAAgB,SAAU,aAAc,cAJ/EN,QACCC,OAAO,aACPiC,QAAQ,OAAQ/B,MAsDnB,WACE,YAOA,SAASW,GAAIX,EAAMwF,GAOjB,QAASrE,KACP,MAAOqE,GAAMC,IACX,8CACEC,SAAWC,cAAiB,UAAY3F,EAAK4E,SAInD,QAAS9D,GAAaG,GACpB,MAAOuE,GAAMI,IACX,6CACA3E,GACEyE,SAAWC,cAAiB,UAAY3F,EAAK4E,SAjBnD,GAAI7C,IACFjB,aAAcA,EACdK,aAAcA,EAEhB,OAAOY,GALTpB,EAAIR,SAAW,OAAQ,SALvBN,QACCC,OAAO,aACPiC,QAAQ,MAAOpB,MA2BlB,WACE,YAWA,SAASkF,GAAiB7F,EAAMoD,EAAYa,GAM1C,QAAS6B,GAASC,GAChB,MAAO9B,GAAO+B,QAAQC,MAAQF,EANhC,GAAI9F,GAAKC,IACTD,GAAGD,KAAOA,EACVC,EAAGmD,WAAaA,EAChBnD,EAAG6F,SAAWA,EAPhBD,EAAiB1F,SAAW,OAAQ,aAAc,UANlDN,QACCC,OAAO,aACPM,UAAU,YACTC,WAAYwF,EACZvF,aAAc,SACdC,YAAa,8BAgBjB,WACE,YAOA,SAAS2F,MALTrG,QACCC,OAAO,aACPO,WAAW,iBAAkB6F,MAOhC,WACE,YAOA,SAASC,GAAqBnG,EAAMoD,GAClC,GAAInD,GAAKC,IACTD,GAAGD,KAAOA,EACVC,EAAGmD,WAAaA,EADlB+C,EAAqBhG,SAAW,OAAQ,cAPxCN,QACCC,OAAO,aACPO,WAAW,uBAAwB8F,MAUtC,WACE,YAWA,SAASC,MATTvG,QACCC,OAAO,aACPM,UAAU,YACTC,WAAY+F,EACZ9F,aAAc,SACdC,YAAa,8BAQjB,WACE,YAOA,SAAS8F,GAAoBrG,GAC3B,GAAIC,GAAKC,IACTD,GAAGD,KAAOA,EACZqG,EAAoBlG,SAAW,QAR/BN,QACCC,OAAO,aACPO,WAAW,sBAAuBgG,MASrC,WACE,YACAxG,SAAQC,OAAO,sBAGjB,WACE,YAOA,SAASgE,GAAM7B,EAAMxB,GAmBnB,QAAS2E,GAAUkB,GACjBC,EAASD,EAGX,QAASpB,KACPsB,IAAOpF,KAAK,SAASqF,GACnBA,EAAMC,kBAAkBxB,WAI5B,QAASC,KACPqB,IAAOpF,KAAK,SAASqF,GACnBA,EAAMC,kBAAkBvB,YAI5B,QAASF,KAGPuB,IAGF,QAASA,KACP,MAAIG,GACKlB,IAEAA,IAAMrE,KAAK,SAASqF,GAIzB,MAHAA,GAAMD,MAAOI,UAAWL,EAAOlB,SAAUC,MAAOiB,EAAOjB,QACvDmB,EAAMC,kBAAkBG,YAAYC,OAAOP,EAAOhB,qBAClDoB,GAAc,EACPF,IAKb,QAAShB,KACP,MAAIsB,GACKtG,EAAGS,QAAQ6F,GAEX9E,EAAKwD,MAAMrE,KAAK,SAAS4F,GAE9B,MADAD,GAAcC,EAAKP,MACZO,EAAKP,QA3DlB,GAAIF,GACAQ,EAAc,KACdJ,GAAc,EAEd5E,GACFqD,UAAWA,EACXH,UAAWA,EACXC,OAAQA,EACRC,QAASA,EAEX,OAAOpD,GAPT+B,EAAM3D,SAAW,OAAQ,MATzBN,QACCC,OAAO,gBACPiC,QAAQ,QAAS+B,MAsEpB,WACE,YAOA,SAAS7B,GAAKxB,EAAIwG,EAAWvG,EAASwG,GAQpC,QAAS1E,GAAQ2E,GACf,MAAO1B,KAAMrE,KAAK,SAAS4F,GACzB,MAAOA,GAAKI,OAAO5E,QAAQ2E,KAI/B,QAAS1B,KACP,GAAI4B,EACF,MAAO5G,GAAG6G,KAAK5G,EAAQsG,KAEvB,IAAIO,GAAW9G,EAAG+G,OAUlB,OATAC,GAAkBC,KAAKH,GAClBI,IACHA,GAAc,EACdC,IAAwBxG,KAAK,SAAS4F,GACpCK,GAAa,EACbM,GAAc,EACdF,EAAkBI,QAAQ,SAASC,GAAKA,EAAE5G,QAAQ8F,QAG/CO,EAASQ,QAIpB,QAASH,KACP,GAAIL,GAAW9G,EAAG+G,OAMlB,OALAQ,KAAa5G,KAAK,SAAS4F,GACzBA,EAAKjG,KAAK,eAAgB,WACxBwG,EAASrG,QAAQ8F,OAGdO,EAASQ,QAGlB,QAASC,KACP,GAAIC,GAAM,uDAENV,EAAW9G,EAAG+G,OAClB9G,GAAQwH,YAAc,WACpBX,EAASrG,QAAQR,EAAQsG,MAE3B,IAAImB,GAASlB,EAAU,GAAGmB,cAAc,SAQxC,OAPAD,GAAOE,QAAU,SAAUC,GACzBpB,EAAS,WACPK,EAASgB,OAAOD,MAGpBH,EAAOK,IAAMP,EACbhB,EAAU,GAAGwB,KAAKC,YAAYP,GACvBZ,EAASQ,QAxDlB,GAAIV,IAAa,EACbM,GAAc,EACdF,IAEJvH,MAAKuF,IAAMA,EACXvF,KAAKsC,QAAUA,EADjBP,EAAK9B,SAAW,KAAM,YAAa,UAAW,YAV9CN,QACCC,OAAO,gBACPiC,QAAQ,OAAQE,MAiEnB,WACE,YAOA,SAAS0G,GAAS3I,GAChBA,EAAKiF,YAKP0D,EAASxI,SAAW,QAXpBN,QACCC,OAAO,aACP8I,IAAID,MAQP,WACE,YAOA,SAASE,GAAaC,EAAgBC,GACpCD,EACC/C,MAAM,QACLiD,YAAU,EACVzI,YAAa,uBACbF,WAAY,iBACZC,aAAc,SAEfyF,MAAM,mBACLiD,YAAU,EACVzI,YAAa,6BACbF,WAAY,uBACZC,aAAc,eAEfyF,MAAM,6BACLkD,IAAK,IACL1I,YAAa,+BACbF,WAAY,sBACZC,aAAc,SAEfyF,MAAM,4BACLkD,IAAK,YACL1I,YAAa,6BACbF,WAAY,qBACZC,aAAc,UAGhByI,EAAmBG,UAAU,KApB/BL,EAAa1I,SAAW,iBAAkB,sBAZ1CN,QACGC,OAAO,aACPyG,OAAOsC,MAoCZ,WACE,YAEAhJ,SACGC,OAAO,aACPqJ,SAAS,WAAYC,UACrBD,SAAS,SAAUE,QACnBF,SAAS,aAAc,4CACvBA,SAAS,eAAgB,+EAG9B,WACE,YAOA,SAAS5C,GAAO+C,EAAcC,GAE5BD,EAAaE,cAAa,GAG1BD,EAAaE,WAAY,EACzBF,EAAaG,QAAU,IACvBH,EAAaI,cAAgB,kBAC7BJ,EAAaK,mBAAoB,EACjCL,EAAaM,aAAc,EAC3BN,EAAaO,uBAAwB,EACrCP,EAAaQ,UAAY,EAH3BxD,EAAOpG,SAAW,eAAgB,gBAblCN,QACGC,OAAO,aACPyG,OAAOA,MAmBZ1G,QAAQC,OAAO,oBAAoB8I,KAAK,iBAAkB,SAASoB,GAAiBA,EAAepE,IAAI,+BAA+B,6IACtIoE,EAAepE,IAAI,yBAAyB,6LAC5CoE,EAAepE,IAAI,6BAA6B,4YAChDoE,EAAepE,IAAI,uBAAuB,yGAC1CoE,EAAepE,IAAI,yBAAyB,gmCAC5CoE,EAAepE,IAAI,6BAA6B,u2DAChDoE,EAAepE,IAAI,2BAA2B","file":"scripts/app-3373202d13.js","sourcesContent":["(function() {\n  'use strict';\n\n  // This module is empty except for the template cache that's used in\n  // production.\n  angular\n    .module('wizweekTemplates', [])\n\n  angular\n    .module('wizweekPy', [\n      'ngAnimate', 'ngCookies', 'ngTouch', 'ngSanitize', 'ngMessages', 'ngAria',\n      'ngResource', 'ui.router', 'ui.bootstrap', 'toastr', 'angular-gapi',\n      'angularSpinner', 'wizweekTemplates'\n    ]);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .component('wwWelcome', {\n    controller: WelcomeController,\n    controllerAs: 'welcome',\n    templateUrl: 'app/welcome/welcome.html'\n  });\n\n  /** @ngInject */\n  function WelcomeController(auth) {\n    var vm = this;\n    vm.auth = auth;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .service('settingsStore', settingsStore);\n\n  /** @ngInject */\n  function settingsStore($q, $window, api) {\n    var settings = null;\n\n    var service = {\n      load: load,\n      save: save\n    }\n    return service;\n\n    function save(value) {\n      return api.saveSettings(value);\n    }\n\n    function load(defaultSettings) {\n      if (settings) {\n        // If we've already loaded the settings once, just give that.\n        return $q.resolve(settings);\n      } else {\n        return api.loadSettings().then(function(resp) {\n          // If the loaded settings lack any of the settings attributes, we will\n          // get them from the default settings.\n          settings = angular.extend({}, defaultSettings, resp.data);\n          parseDates(settings.workStartTimes);\n          parseDates(settings.workEndTimes);\n          return settings;\n        });\n      }\n    }\n\n    function parseDates(values) {\n      for (var i = 0; i < values.length; i++) {\n        values[i] = new Date(values[i]);\n      }\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .controller('SettingsController', SettingsController);\n\n  /** @ngInject */\n  function SettingsController(GApi, $log, settingsStore, toastr) {\n    var vm = this;\n    vm.calendars = [];\n    vm.weekDays = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];\n    var defaultSettings = {\n      appointmentsCalId: null, tasksCalId: null,\n\n      // Default work times are 9am-5pm Mon-Fri and just an empty 9am-9am for\n      // Sun (first day of week) and Sat (last day of week).\n      workStartTimes: Array(7).fill(new Date(0, 0, 0, 9)),\n      workEndTimes: [new Date(0, 0, 0, 9)].concat(\n        Array(5).fill(new Date(0, 0, 0, 17))).concat(\n        [new Date(0, 0, 0, 9)])\n    }\n\n    vm.settings = {};\n    vm.saveSettings = saveSettings;\n\n    activate();\n\n    function activate() {\n      loadCalendars();\n      loadSettings();\n    }\n\n    function loadSettings() {\n      settingsStore.load(defaultSettings).then(function(loadedSettings) {\n        vm.settings = loadedSettings;\n      });\n    }\n\n    function saveSettings() {\n      settingsStore.save(vm.settings).then(function() {\n        toastr.success('Settings saved!');\n      });\n    }\n\n    function loadCalendars() {\n      GApi.request({\n        path: '/calendar/v3/users/me/calendarList'\n      }).then(\n        function(resp) {\n          vm.calendars = resp.result.items;\n        },\n        function() {\n          vm.calendars = [];\n          $log.debug('Calendar call failed!');\n        }\n      );\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .service('lastSignIn', lastSignIn);\n\n  /** @ngInject */\n  function lastSignIn($window) {\n    var service = {\n      isLikelyActive: isLikelyActive,\n      signedIn: signedIn,\n      signedOut: signedOut\n    }\n    return service;\n\n    function signedIn(expiresAt) {\n      $window.localStorage.signInExpiry = expiresAt;\n    }\n\n    function signedOut() {\n      $window.localStorage.signInExpiry = 0;\n    }\n\n    function isLikelyActive() {\n      var signInExpiry = $window.localStorage.signInExpiry;\n      if (!signInExpiry) {\n        return false;\n      } else {\n        var msLeft = parseInt(signInExpiry) - new Date().getTime();\n        return msLeft > 0;\n      }\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .service('auth', auth);\n\n  /** @ngInject */\n  function auth(GAuth, gapiScopes, gapiClientId, $state, $rootScope, lastSignIn) {\n    GAuth.setConfig({\n      clientId: gapiClientId,\n      scope: gapiScopes,\n      currentUserListener: currentUserChanged\n    });\n\n    var service = {\n      checkAuth: checkAuth,\n      signIn: signIn,\n      signOut: signOut,\n      signedIn: false,\n      signingIn: false,\n      userEmail: null,\n      userName: null,\n      token: null\n    }\n    return service;\n\n    function currentUserChanged(user) {\n      service.signingIn = false;\n      service.signedIn = user.isSignedIn();\n      if (service.signedIn) {\n        service.userEmail = user.getBasicProfile().getEmail();\n        service.userName = user.getBasicProfile().getName();\n        service.token = user.getAuthResponse().access_token;\n        lastSignIn.signedIn(user.getAuthResponse().expires_at);\n      } else {\n        service.userEmail = null;\n        service.userName = null;\n        service.token = null;\n        lastSignIn.signedOut();\n      }\n      $rootScope.$digest();\n    }\n\n    function checkAuth() {\n      GAuth.checkAuth();\n    }\n\n    function signIn() {\n      service.signingIn = true;\n      GAuth.signIn();\n    }\n\n    function signOut() {\n      GAuth.signOut();\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .service('api', api);\n\n  /** @ngInject */\n  function api(auth, $http) {\n    var service = {\n      saveSettings: saveSettings,\n      loadSettings: loadSettings\n    };\n    return service;\n\n    function loadSettings() {\n      return $http.get(\n        'https://wizweek-api.herokuapp.com/settings',\n        { headers: { 'Authorization': 'Bearer ' + auth.token } }\n      );\n    }\n\n    function saveSettings(settings) {\n      return $http.put(\n        'https://wizweek-api.herokuapp.com/settings',\n        settings,\n        { headers: { 'Authorization': 'Bearer ' + auth.token } }\n      )\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .component('wwNavbar', {\n    controller: NavbarController,\n    controllerAs: 'navbar',\n    templateUrl: 'app/navbar/navbar.html'\n  });\n\n  /** @ngInject */\n  function NavbarController(auth, lastSignIn, $state) {\n    var vm = this;\n    vm.auth = auth;\n    vm.lastSignIn = lastSignIn;\n    vm.isActive = isActive;\n\n    function isActive(state) {\n      return $state.current.name == state;\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .controller('MainController', MainController);\n\n  /** @ngInject */\n  function MainController() {\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .controller('AuthorizedController', AuthorizedController);\n\n  /** @ngInject */\n  function AuthorizedController(auth, lastSignIn) {\n    var vm = this;\n    vm.auth = auth;\n    vm.lastSignIn = lastSignIn;\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .component('wwFooter', {\n    controller: FooterController,\n    controllerAs: 'footer',\n    templateUrl: 'app/footer/footer.html'\n  });\n\n  /** @ngInject */\n  function FooterController() {\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .controller('DashboardController', DashboardController);\n\n  /** @ngInject */\n  function DashboardController(auth) {\n    var vm = this;\n    vm.auth = auth;\n  }\n})();\n\n(function() {\n  'use strict';\n  angular.module('angular-gapi', []);\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('angular-gapi')\n  .service('GAuth', GAuth);\n\n  /** @ngInject */\n  function GAuth(GApi, $q) {\n    var config;\n    var cachedAuth2 = null;\n    var initialized = false;\n\n    var service = {\n      setConfig: setConfig,\n      checkAuth: checkAuth,\n      signIn: signIn,\n      signOut: signOut\n    };\n    return service;\n\n    // Takes an object like this:\n    // {\n    //   clientId: 'xyz.apps.googleusercontent.com',\n    //   scope: 'https://www.googleapis.com/auth/calendar',\n    //   currentUserListener: function(currentUser) { ... }\n    // }\n    function setConfig(conf) {\n      config = conf;\n    }\n\n    function signIn() {\n      init().then(function(auth2) {\n        auth2.getAuthInstance().signIn();\n      });\n    }\n\n    function signOut() {\n      init().then(function(auth2) {\n        auth2.getAuthInstance().signOut();\n      });\n    }\n\n    function checkAuth() {\n      // init() checks the authentiation but by just calling it (but not\n      // returning it) we avoid exposing promise that would return the auth2 instance.\n      init();\n    }\n\n    function init() {\n      if (initialized) {\n        return get();\n      } else {\n        return get().then(function(auth2) {\n          auth2.init({ client_id: config.clientId, scope: config.scope });\n          auth2.getAuthInstance().currentUser.listen(config.currentUserListener);\n          initialized = true;\n          return auth2;\n        });\n      }\n    }\n\n    function get() {\n      if (cachedAuth2) {\n        return $q.resolve(cachedAuth2);\n      } else {\n        return GApi.get().then(function(gapi) {\n          cachedAuth2 = gapi.auth2;\n          return gapi.auth2;\n        });\n      }\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('angular-gapi')\n  .service('GApi', GApi);\n\n  /** @ngInject */\n  function GApi($q, $document, $window, $timeout) {\n    var gapiLoaded = false;\n    var gapiLoading = false;\n    var observerCallbacks = [];\n\n    this.get = get;\n    this.request = request;\n\n    function request(args) {\n      return get().then(function(gapi) {\n        return gapi.client.request(args);\n      });\n    }\n\n    function get() {\n      if (gapiLoaded) {\n        return $q.when($window.gapi);\n      } else {\n        var deferred = $q.defer();\n        observerCallbacks.push(deferred);\n        if (!gapiLoading) {\n          gapiLoading = true;\n          loadWithClientAndAuth().then(function(gapi) {\n            gapiLoaded = true;\n            gapiLoading = false;\n            observerCallbacks.forEach(function(c) { c.resolve(gapi); });\n          });\n        }\n        return deferred.promise;\n      }\n    }\n\n    function loadWithClientAndAuth() {\n      var deferred = $q.defer();\n      loadScript().then(function(gapi) {\n        gapi.load('client:auth2', function() {\n          deferred.resolve(gapi);\n        });\n      });\n      return deferred.promise;\n    }\n\n    function loadScript() {\n      var URL = 'https://apis.google.com/js/api.js?onload=_gapiOnLoad';\n\n      var deferred = $q.defer();\n      $window._gapiOnLoad = function(){\n        deferred.resolve($window.gapi);\n      }\n      var script = $document[0].createElement('script');\n      script.onerror = function (e) {\n        $timeout(function () {\n          deferred.reject(e);\n        });\n      };\n      script.src = URL;\n      $document[0].body.appendChild(script);\n      return deferred.promise;\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('wizweekPy')\n  .run(runBlock);\n\n  /** @ngInject */\n  function runBlock(auth) {\n    auth.checkAuth();\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wizweekPy')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n    .state('main',  {\n      abstract: true,\n      templateUrl: 'app/layout/main.html',\n      controller: 'MainController',\n      controllerAs: 'main'\n    })\n    .state('main.authorized', {\n      abstract: true,\n      templateUrl: 'app/layout/authorized.html',\n      controller: 'AuthorizedController',\n      controllerAs: 'authorized'\n    })\n    .state('main.authorized.dashboard', {\n      url: '/',\n      templateUrl: 'app/dashboard/dashboard.html',\n      controller: 'DashboardController',\n      controllerAs: 'dash'\n    })\n    .state('main.authorized.settings', {\n      url: '/settings',\n      templateUrl: 'app/settings/settings.html',\n      controller: 'SettingsController',\n      controllerAs: '$ctrl'\n    })\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n/* global malarkey:false, moment:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('wizweekPy')\n    .constant('malarkey', malarkey)\n    .constant('moment', moment)\n    .constant('gapiScopes', 'https://www.googleapis.com/auth/calendar')\n    .constant('gapiClientId', '562801966668-qu83ib47l7bqcddpvd7qtkescdohg4e7.apps.googleusercontent.com')\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('wizweekPy')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider, toastrConfig) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n\n    // Set options third-party lib\n    toastrConfig.allowHtml = true;\n    toastrConfig.timeOut = 1000;\n    toastrConfig.positionClass = 'toast-top-right';\n    toastrConfig.preventDuplicates = false;\n    toastrConfig.progressBar = false;\n    toastrConfig.preventOpenDuplicates = true;\n    toastrConfig.maxOpened = 1;\n  }\n\n})();\n\nangular.module(\"wizweekTemplates\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/dashboard/dashboard.html\",\"<div class=row><div class=col-md-5><h3>Tasks</h3></div></div>Welcome {{dash.auth.userName}}! This page will soon display a list of tasks.\");\n$templateCache.put(\"app/footer/footer.html\",\"<hr><div class=container><div class=row><div class=col-md-12><p>&copy; 2015 David Raffensperger. <a href=https://github.com/draffensperger/wizweek>Source code.</a></p></div></div></div>\");\n$templateCache.put(\"app/layout/authorized.html\",\"<ww-welcome ng-show=\\\"!authorized.auth.signedIn && !authorized.lastSignIn.isLikelyActive()\\\"></ww-welcome><div ng-show=\\\"!authorized.auth.signedIn && authorized.lastSignIn.isLikelyActive()\\\"><span us-spinner=\\\"{radius:30, width:8, length: 16}\\\"></span></div><div class=\\\"container main-content\\\" ng-if=authorized.auth.signedIn><div class=row><div class=col-md-12><div ui-view></div></div></div></div>\");\n$templateCache.put(\"app/layout/main.html\",\"<article><ww-navbar></ww-navbar><div ui-view></div></article><footer><ww-footer></ww-footer></footer>\");\n$templateCache.put(\"app/navbar/navbar.html\",\"<nav class=\\\"navbar navbar-inverse navbar-fixed-top\\\"><div class=container><div class=navbar-header><button type=button class=\\\"navbar-toggle collapsed\\\" data-toggle=collapse data-target=#navbar aria-expanded=false aria-controls=navbar><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=\\\"nav navbar-brand\\\" ui-sref=home>WizWeek</a></div><div id=navbar class=\\\"navbar-collapse collapse\\\"><ul class=\\\"nav navbar-nav\\\" ng-show=navbar.auth.signedIn><li ng-class=\\\"{ active: navbar.isActive(\\'home\\')}\\\"><a ui-sref=main.authorized.dashboard>Tasks</a></li><li ng-class=\\\"{ active: navbar.isActive(\\'settings\\')}\\\"><a ui-sref=main.authorized.settings>Settings</a></li></ul><form class=\\\"navbar-text navbar-form navbar-right\\\"><div ng-show=navbar.auth.signedIn>{{navbar.auth.userEmail}} <a ng-click=navbar.auth.signOut() href=\\\"\\\">Log out</a></div><div ng-show=\\\"!navbar.auth.signedIn && !navbar.lastSignIn.isLikelyActive()\\\"><a ng-click=navbar.auth.signIn() href=\\\"\\\">Login with Google</a></div></form></div><!--/.navbar-collapse --></div></nav>\");\n$templateCache.put(\"app/settings/settings.html\",\"<div class=row><div class=col-md-5><h3>Settings</h3></div></div><div class=row><div class=col-md-5><h4>Calendars</h4></div></div><div class=row><div class=col-md-5><div class=form-group><label for=appointments-cal>Appointments calendar</label><select id=appointments-cal class=form-control ng-options=\\\"cal.id as cal.summary for cal in $ctrl.calendars\\\" ng-model=$ctrl.settings.appointmentsCalId ng-change=$ctrl.saveSettings()></select>WizWeek will treat events on this calendar as fixed meetings and will schedule your project tasks around them.</div></div><div class=col-md-5><div class=form-group><label for=tasks-cal>Tasks calendar (will be overwritten)</label><select id=tasks-cal class=form-control ng-options=\\\"cal.id as cal.summary for cal in $ctrl.calendars\\\" ng-model=$ctrl.settings.tasksCalId ng-change=$ctrl.saveSettings()></select>WizWeek will <b>overwrite future events</b> on this calendar and replace them with automatically scheduled project work tasks.</div></div></div><div class=row><div class=col-md-5><h4>Work Schedule</h4>WizWeek will schedule your project tasks within your work hours, except when you have an event in your appointments calendar.</div></div><div class=row><div class=col-md-1><h5>Day</h5></div><div class=col-md-2><h5>Start</h5></div><div class=col-md-2><h5>End</h5></div></div><div class=row ng-repeat=\\\"day in $ctrl.weekDays\\\"><div class=col-md-1>{{day}}</div><div class=col-md-2><div uib-timepicker hour-step=1 minute-step=1 show-spinners=false mousewheel=false pad-hours=false ng-model-options=\\\"{ debounce:800 }\\\" ng-change=$ctrl.saveSettings() ng-model=$ctrl.settings.workStartTimes[$index]></div></div><div class=col-md-2><div uib-timepicker hour-step=1 minute-step=1 show-spinners=false mousewheel=false pad-hours=false ng-model-options=\\\"{ debounce:800 }\\\" ng-change=$ctrl.saveSettings() ng-model=$ctrl.settings.workEndTimes[$index]></div></div></div>\");\n$templateCache.put(\"app/welcome/welcome.html\",\"<!-- Main jumbotron for a primary marketing message or call to action --><div class=jumbotron><div class=container><h1>Want to optimize your week?</h1><p>WizWeek helps you effectively plan your week based on your to-do list and appointments.</p><p>You define tasks with deadlines, estimates and business value - and WizWeek jump starts your schedule.</p><p><a class=\\\"btn btn-primary btn-lg\\\" role=button ng-click=welcome.auth.signIn()>Sign in with Google to get started &raquo;</a></p></div></div><div class=container><!-- Example row of columns --><div class=row><div class=col-md-6><h2>Clarify your priorities</h2><blockquote><p>&ldquo;What do you do the last week before you leave on a big trip? You clean up, close up, clarify, and renegotiate all your agreements with yourself and others. I just suggest that you do this weekly instead of yearly.&rdquo;</p><footer>David Allen of <cite title=\\\"Getting Things Done\\\">Getting Things Done</cite></footer></blockquote></div><div class=col-md-6><h2>Schedule your work</h2><blockquote><p>&ldquo;Just as there is only so much stuff we can fit into our closets, so also there is only so much stuff we can fit into our days. If we don\\'t think in terms of a basic schedule ... we end up in overload.&rdquo;</p><footer>Matt Perman of <cite title=\\\"What\\'s Best Next\\\">What\\'s Best Next</cite></footer></blockquote></div></div><hr><footer><p>&copy; 2015 David Raffensperger</p></footer></div><!-- /container -->\");}]);"],"sourceRoot":"/source/"}